job('DevCompile_DSL') {
    label('test_label')
    description('Maven Compile Job generated by DSL')

scm {
   git('https://github.com/devops2615/DevOpsClassCodes.git')
}

steps {
       maven{
      mavenInstallation('mymaven')
  goals('compile')
       }
}
publishers {
        downstream('DevCodeReview_DSL', 'SUCCESS')
    }
}

job('DevCodeReview_DSL') {

triggers {
        upstream('DevCompile_DSL', 'SUCCESS')
    }

    description('Maven Code Review Job generated by DSL')

scm {
   git('https://github.com/devops2615/DevOpsClassCodes.git')
}

steps {
       maven{
      mavenInstallation('mymaven')
  goals('-Pmetrics pmd:pmd')
       }
}
publishers {
        downstream('QAUnitTest_DSL', 'SUCCESS')
pmd('target/pmd.xml')
    }
}

job('QAUnitTest_DSL') {

triggers {
        upstream('DevCodeReview_DSL', 'SUCCESS')
    }

    description('Maven QA Unit Test Job generated by DSL')

scm {
   git('https://github.com/devops2615/DevOpsClassCodes.git')
}

steps {
       maven{
      mavenInstallation('mymaven')
  goals('test')
       }
}
publishers {
        downstream('QAMetricJob_DSL', 'SUCCESS')
archiveJunit('target/surefire-reports/*.xml')
    }
}

job('QAMetricJob_DSL') {

triggers {
        upstream('QAUnitTest_DSL', 'SUCCESS')
    }

    description('Maven QA Metric Job generated by DSL')

scm {
   git('https://github.com/devops2615/DevOpsClassCodes.git')
}

steps {
       maven{
      mavenInstallation('mymaven')
  goals('cobertura:cobertura -Dcobertura.report.format=xml')
       }
}
publishers {
        downstream('Package_DSL', 'SUCCESS')
archiveJunit('target/surefire-reports/*.xml')
cobertura('target/site/cobertura/coverage.xml') {
            failNoReports(true)
            sourceEncoding('ASCII')

            // the following targets are added by default to check the method, line and conditional level coverage
            methodTarget(80, 0, 0)
            lineTarget(80, 0, 0)
            conditionalTarget(70, 0, 0)
        }
    }
}

job('Package_DSL') {

triggers {
        upstream('QAMetricJob_DSL', 'SUCCESS')
    }
    description('Maven Package Job generated by DSL')
scm {
   git('https://github.com/devops2615/DevOpsClassCodes.git')
}
steps {
       maven{
      mavenInstallation('mymaven')
  goals('package')
       }
}
}